<!doctype html><html lang=en><head><link href=//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fontawesome-all.min.css rel=stylesheet></noscript><link href=/css/featherlight.min.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/featherlight.min.css rel=stylesheet></noscript><link href=/css/nucleus.css rel=stylesheet><link href=/css/fonts.css rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/css/fonts.css rel=stylesheet></noscript><link href=/css/theme.css rel=stylesheet><link href=/css/theme-relearn-light.css rel=stylesheet id=variant-style><link href=/css/print.css rel=stylesheet media=print><script src=/js/variant.js?1754062304></script>
<script>var root_url="/",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="",window.T_Copied_to_clipboard="",window.T_Copy_link_to_clipboard="",window.T_Link_copied_to_clipboard="",baseUriFull="http://localhost/",window.variants&&variants.init(["relearn-light"])</script><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta itemprop=description property="description" content="Building a GraphRAG pipeline using ArangoDB&amp;rsquo;s integrated notebook servers"><meta property="og:url" content="http://localhost/3.12/data-science/graphrag/tutorial-notebook/"><meta property="og:title" content="GraphRAG Notebook Tutorial"><meta property="og:type" content="website"><meta property="og:description" content="Building a GraphRAG pipeline using ArangoDB&amp;rsquo;s integrated notebook servers"><meta name=docsearch:version content="3.12"><title>GraphRAG Notebook Tutorial | ArangoDB Documentation</title><link href=/images/favicon.png rel=icon type=image/png><script src=/js/jquery.min.js></script>
<script src=/js/clipboard.min.js?1754062304 defer></script>
<script src=/js/featherlight.min.js?1754062304 defer></script>
<script>var versions=[{alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"},{alias:"stable",deprecated:!1,name:"3.12",version:"3.12.5"},{alias:"3.11",deprecated:!0,name:"3.11",version:"3.11.14"},{alias:"3.10",deprecated:!0,name:"3.10",version:"3.10.14"}]</script><script>var develVersion={alias:"devel",deprecated:!1,name:"3.13",version:"3.13.0"}</script><script>var stableVersion={alias:"stable",deprecated:!1,name:"3.12",version:"3.12.5"}</script><script src=/js/codeblocks.js?1754062304 defer></script>
<script src=/js/theme.js?1754062304 defer></script></head><body><noscript>You need to enable JavaScript to use the ArangoDB documentation.</noscript><div id=page-wrapper class=page_content_splash style=height:auto;opacity:0><section id=page-main><section class=page-container id=page-container><header id=header style="transition:.5s padding ease-out,.15s" class="zn_header_white header-splash-new nav-down header-splash-wrap header1"><div class=header-block-left><div class=mobile-menu-toggle><button id=sidebar-toggle-navigation onclick=showSidebarHandler()><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div><div class=version-logo-container><div class="logo-container hasinfocard_img arangodb-logo-large"><div class=logo><a href=https://www.arangodb.com/><img src=/images/logo_main.png alt=ArangoDB title></a></div></div><div class=arangodb-logo-small><a href=https://arangodb.com/><img alt="ArangoDB Logo" src=/images/ArangoDB_Logo_White_small.png></a></div></div></div><div class=container-right style=display:hidden></div><div class=search-and-version-container><a href=# class="home-link is-current" aria-label="Go to home page" onclick=goToHomepage(event)></a><div id=searchbox></div><script type=text/javascript>const SCRIPT_SRC="https://unpkg.com/@inkeep/widgets-embed@0.2.290/dist/embed.js";function loadAndInitializeInkeep(){if(document.querySelector(`script[src="${SCRIPT_SRC}]"`))return;const e=document.createElement("script");e.type="module",e.src=SCRIPT_SRC,e.onload=initializeInkeep,document.head.appendChild(e)}function initializeInkeep(){const e=Inkeep({integrationId:"clo4lx6jk0000s601cp21x2ok",apiKey:"13b4e56966a76e86c6ff359cd795ee6a0412f751d75d6383",organizationId:"org_HGBkkzGAa4KeGJGh",organizationDisplayName:"ArangoDB",primaryBrandColor:"#80a54d",stringReplacementRules:[{matchingRule:{ruleType:"Substring",string:"Arangograph"},replaceWith:"ArangoGraph"},{matchingRule:{ruleType:"Substring",string:"Aql"},replaceWith:"AQL"},{matchingRule:{ruleType:"Substring",string:"Arangodb"},replaceWith:"ArangoDB"}],customCardSettings:[{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arango.qubitpi.org"}},searchTabLabel:"Official Docs"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"developer.arangodb.com"}},searchTabLabel:"Developer Hub"},{filters:{UrlMatch:{ruleType:"PartialUrl",partialUrl:"arangodb.com"}},searchTabLabel:"Home"}]}),t=e.embed({componentType:"ChatButton",properties:{stylesheetUrls:["/css/fonts.css"],fixedPositionXOffset:"52px",baseSettings:{theme:{primaryColors:{textColorOnPrimary:"white"},tokens:{fonts:{body:"'Inter'",heading:"'Inter'"},zIndex:{overlay:1e4,modal:11e3,popover:12e3,skipLink:13e3,toast:14e3,tooltip:15e3}}}},aiChatSettings:{botAvatarSrcUrl:"/images/ArangoDB_Logo_White_small.png",quickQuestions:["What can you do with AQL that is not feasible with SQL?","How do I search for objects within arrays?","Where can I deploy my ArangoDB instance?"],getHelpCallToActions:[{icon:{builtIn:"FaSlack"},name:"Slack",url:"https://arangodb-community.slack.com/"}]},searchSettings:{tabSettings:{isAllTabEnabled:!1,alwaysDisplayedTabs:["Official Docs","Developer Hub","Home"]}}}})}loadAndInitializeInkeep()</script><div class=version-selector><select id=arangodb-version onchange=changeVersion()><option value=3.13>3.13</option><option value=3.12>3.12</option><option value=3.11>3.11</option><option value=3.10>3.10</option><option value=3.9>3.9</option><option value=3.8>3.8</option></select></div></div></header><iframe src=/nav.html title=description id=menu-iframe class="menu-iframe active" style=opacity:0></iframe><div class=container-main><div class=row-main><nav id=breadcrumbs><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3.12"><a itemprop=item class=link href=/3.12/><span itemprop=name class=breadcrumb-entry>3.12.5</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="GenAI & Data Science"><a itemprop=item class=link href=/3.12/data-science/><span itemprop=name class=breadcrumb-entry>GenAI & Data Science</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="GraphRAG"><a itemprop=item class=link href=/3.12/data-science/graphrag/><span itemprop=name class=breadcrumb-entry>GraphRAG</span></a>
<i class="fas fa-chevron-right fa-fw"></i></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="Notebook Tutorial"><a itemprop=item class=link href=/3.12/data-science/graphrag/tutorial-notebook/><span itemprop=name class=breadcrumb-entry>Notebook Tutorial</span></a></li></ol></nav><article class=default><hgroup><h1>GraphRAG Notebook Tutorial</h1><p class=lead>Building a GraphRAG pipeline using ArangoDB&rsquo;s integrated notebook servers</p></hgroup><p class=labels><span class=label>ArangoDB Platform</span></p><div class="box notices cstyle tip"><div class=box-content-container><div class=box-content><i class="fas fa-check"></i><div class=box-text>The ArangoDB Platform & GenAI Suite is available as a pre-release. To get
exclusive early access, <a href=https://arangodb.com/contact/ target=_blank rel="noopener noreferrer" class=link>get in touch</a>&nbsp;<i class="fas fa-external-link-alt"></i> with
the ArangoDB team.</div></div></div></div><h2 id=tutorial-overview>Tutorial overview <a href=/3.12/data-science/graphrag/tutorial-notebook/#tutorial-overview class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>This tutorial guides you through the process of building a
Graph-based Retrieval Augmented Generation (GraphRAG) pipeline using
ArangoDB&rsquo;s integrated Notebook servers. GraphRAG is an advanced framework that
combines the power of knowledge graphs (KGs) and large language models (LLMs)
to provide precise and contextually relevant responses from unstructured text data.</p><p>You will learn how to:</p><ul><li>Prepare your raw text data (PDFs in this case) into a structured format
suitable for Knowledge Graph extraction using Docling.</li><li>Utilize the ArangoDB Importer service to automatically extract
entities and relationships from your prepared text and store them as a
Knowledge Graph in ArangoDB.</li><li>Query your newly created Knowledge Graph using the ArangoDB Retriever
service for both broad (global) and targeted (local) information retrieval.</li><li>Set up a simple Gradio interface to interact with your GraphRAG pipeline.</li></ul><h2 id=prerequisites>Prerequisites <a href=/3.12/data-science/graphrag/tutorial-notebook/#prerequisites class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Before you begin, ensure you have the following:</p><ul><li><strong>ArangoDB deployment:</strong> Access to an ArangoDB deployment where you can
create and manage databases. You need the endpoint, your username, and
write access to your chosen database.</li><li><strong>Python environment:</strong> A Python 3.x environment with <code>pip</code> installed.</li><li><strong>Jupyter Notebook:</strong> This tutorial is designed to be run in ArangoDB&rsquo;s integrated
Notebook servers.</li><li><strong>OpenAI API key (optional):</strong> If you plan to use OpenAI&rsquo;s models for LLM
processing, you need an OpenAI API key. Alternatively, you can configure the
services to use other providers like Ollama.</li></ul><h2 id=environment-setup>Environment setup <a href=/3.12/data-science/graphrag/tutorial-notebook/#environment-setup class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>This section covers installing necessary libraries, importing Python modules,
and setting up the network functions for interacting with ArangoDB services.</p><h3 id=install-required-libraries>Install required libraries <a href=/3.12/data-science/graphrag/tutorial-notebook/#install-required-libraries class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>First, install all the Python libraries necessary for PDF parsing, Markdown
conversion, and interacting with the ArangoDB GraphRAG services.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=err>!</span> <span class=n>pip</span> <span class=n>install</span> <span class=n>fitz</span>
</span></span><span class=line><span class=cl><span class=err>!</span> <span class=n>pip</span> <span class=n>install</span> <span class=n>PyMuPDF</span>
</span></span><span class=line><span class=cl><span class=err>!</span> <span class=n>pip</span> <span class=n>install</span> <span class=n>PyPDF2</span>
</span></span><span class=line><span class=cl><span class=err>!</span> <span class=n>pip</span> <span class=n>install</span> <span class=n>markdownify</span>
</span></span><span class=line><span class=cl><span class=err>!</span> <span class=n>pip</span> <span class=n>install</span> <span class=n>docling</span><span class=o>==</span><span class=mf>2.26.0</span>
</span></span><span class=line><span class=cl><span class=err>!</span> <span class=n>pip</span> <span class=n>install</span> <span class=n>gradio</span>
</span></span></code></pre></div><h3 id=import-required-python-libraries>Import required Python libraries <a href=/3.12/data-science/graphrag/tutorial-notebook/#import-required-python-libraries class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Next, import the specific modules and functions used throughout the tutorial.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>fitz</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PyPDF2</span> <span class=kn>import</span> <span class=n>PdfReader</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>docling.document_converter</span> <span class=kn>import</span> <span class=n>DocumentConverter</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>markdownify</span> <span class=kn>import</span> <span class=n>markdownify</span> <span class=k>as</span> <span class=n>md</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>Optional</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pprint</span> <span class=kn>import</span> <span class=n>pprint</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span></code></pre></div><h2 id=step-1-prepare-your-document>Step 1: Prepare your document <a href=/3.12/data-science/graphrag/tutorial-notebook/#step-1-prepare-your-document class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><div class="box notices cstyle warning"><div class=box-content-container><div class=box-content><i class="fas fa-exclamation-triangle"></i><div class=box-text><p>GraphRAG currently supports <code>.txt</code> and <code>.md</code> formats only. If your document is
in <code>.pdf</code> format, you must convert it into a structured Markdown format using Docling.</p><p>You can only import one file using the pre-release version of ArangoDB GraphRAG.
Importing another file overwrites the knowledge graph.</p></div></div></div></div><p><a href=https://docling-project.github.io/docling/ target=_blank rel="noopener noreferrer" class=link>Docling</a>&nbsp;<i class="fas fa-external-link-alt"></i> from IBM is an AI-based PDF
parsing tool designed to convert complex PDFs into Markdown. This conversion is
crucial for efficient extraction of entities and relationships in the next stage.</p><p>The following process creates a Markdown file for you (e.g., <code>AliceInWonderland_docling.md</code>)
from your PDF. The file is automatically added in the file browser of the Jupyter
notebook interface.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=c1># --- Configuration for your document and database ---</span>
</span></span><span class=line><span class=cl><span class=n>DB_NAME</span> <span class=o>=</span> <span class=s2>&#34;documentation&#34;</span> <span class=c1># Set the name of the ArangoDB database you will use for your knowledge graph. Ensure this database already exists in your ArangoDB Deployment.</span>
</span></span><span class=line><span class=cl><span class=n>FILE_NAME</span> <span class=o>=</span> <span class=s2>&#34;AliceInWonderland&#34;</span> <span class=c1># Specify the base name of your input file (e.g., &#39;AliceInWonderland&#39; for &#39;AliceInWonderland.pdf&#39;).</span>
</span></span><span class=line><span class=cl><span class=n>PDF_NAME</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;./</span><span class=si>{</span><span class=n>FILE_NAME</span><span class=si>}</span><span class=s2>.pdf&#34;</span> <span class=c1># Update the file path and extension if your input document is not a PDF or has a different name.</span>
</span></span><span class=line><span class=cl><span class=c1># ----------------------------------------------------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>%%</span><span class=n>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>pdf_to_markdown_docling</span><span class=p>(</span><span class=n>pdf_file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Converts a PDF file to Markdown using Docling.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>converter</span> <span class=o>=</span> <span class=n>DocumentConverter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>converter</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=n>pdf_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>output_md_file</span> <span class=o>=</span> <span class=n>pdf_file</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;.pdf&#34;</span><span class=p>,</span> <span class=s2>&#34;_docling.md&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_md_file</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>md_file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>md_file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>document</span><span class=o>.</span><span class=n>export_to_markdown</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Successfully converted </span><span class=si>{</span><span class=n>pdf_file</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>output_md_file</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>pdf_to_markdown_docling</span><span class=p>(</span><span class=n>PDF_NAME</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;An error occurred during PDF to Markdown conversion: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>The next step is to encode the content of the Markdown file into Base64,
which is required for the Importer service.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=o>%%</span><span class=n>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>encode_file_content</span><span class=p>(</span><span class=n>file_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Encodes the file content to Base64.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>encoded_content</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>file</span><span class=o>.</span><span class=n>read</span><span class=p>())</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Successfully encoded file: </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>encoded_content</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>FileNotFoundError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;File not found: </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error reading file </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>file_content</span> <span class=o>=</span> <span class=n>encode_file_content</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;./</span><span class=si>{</span><span class=n>FILE_NAME</span><span class=si>}</span><span class=s2>_docling.md&#34;</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=step-2-import-your-document-to-generate-the-knowledge-graph>Step 2: Import your document to generate the Knowledge Graph <a href=/3.12/data-science/graphrag/tutorial-notebook/#step-2-import-your-document-to-generate-the-knowledge-graph class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>Once your document is prepared, you can start the Importer service. This
service takes your processed Markdown content, extracts entities and relationships,
and then stores this structured information as a Knowledge Graph within
your specified ArangoDB database.</p><h3 id=start-the-importer-service>Start the Importer service <a href=/3.12/data-science/graphrag/tutorial-notebook/#start-the-importer-service class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Start the Importer service providing the necessary configuration
parameters.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=o>%%</span><span class=n>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Start the GraphRAG Importer service</span>
</span></span><span class=line><span class=cl><span class=n>importer_config</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;db_name&#34;</span><span class=p>:</span> <span class=n>DB_NAME</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;username&#34;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s2>&#34;USERNAME&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;api_provider&#34;</span><span class=p>:</span> <span class=s2>&#34;openai&#34;</span><span class=p>,</span> <span class=c1># Switch the provider if needed (e.g., &#39;ollama&#39; or &#39;openai&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;openai_api_key&#34;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s2>&#34;OPENAI_API_KEY&#34;</span><span class=p>],</span> <span class=c1># Required if api_provider is &#39;openai&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>response</span> <span class=o>=</span> <span class=n>start_service</span><span class=p>(</span><span class=s2>&#34;arangodb-graphrag-importer&#34;</span><span class=p>,</span> <span class=n>importer_config</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pprint</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Extract the service ID for future reference</span>
</span></span><span class=line><span class=cl><span class=n>importer_service_id</span> <span class=o>=</span> <span class=n>response</span><span class=p>[</span><span class=s2>&#34;serviceInfo&#34;</span><span class=p>][</span><span class=s2>&#34;serviceId&#34;</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;-&#34;</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Importer Service ID: </span><span class=si>{</span><span class=n>importer_service_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=submit-your-document>Submit your document <a href=/3.12/data-science/graphrag/tutorial-notebook/#submit-your-document class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>With the importer service running, submit your Base64 encoded Markdown file.
The service will process it in the background to build the Knowledge Graph.</p><div class="box notices cstyle info"><div class=box-content-container><div class=box-content><i class="fas fa-info-circle"></i><div class=box-text>This process can take some time depending on the document&rsquo;s size and complexity.</div></div></div></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=o>%%</span><span class=n>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Submit the prepared file to generate the Knowledge Graph</span>
</span></span><span class=line><span class=cl><span class=n>importer_payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;file_name&#34;</span><span class=p>:</span> <span class=n>FILE_NAME</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;file_content&#34;</span><span class=p>:</span> <span class=n>file_content</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>importerResponse</span> <span class=o>=</span> <span class=n>send_request</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;/graphrag/importer/</span><span class=si>{</span><span class=n>importer_service_id</span><span class=si>}</span><span class=s2>/v1/import&#34;</span><span class=p>,</span> <span class=n>importer_payload</span><span class=p>,</span> <span class=s2>&#34;POST&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pprint</span><span class=p>(</span><span class=n>importerResponse</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=visualize-and-interact-with-the-knowledge-graph>Visualize and interact with the Knowledge Graph <a href=/3.12/data-science/graphrag/tutorial-notebook/#visualize-and-interact-with-the-knowledge-graph class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Once the importer service has processed the document, you can visualize and
interact with the generated Knowledge Graph using the <a href=/3.12/graphs/graph-visualizer/ class=link>Graph Visualizer</a>
directly from the ArangoDB Platform web interface.</p><ol><li>In the ArangoDB Platform web interface, select the database you have previously used.</li><li>Click <strong>Graphs</strong> in the main navigation.</li><li>Select the graph named <strong>Knowledge Graph</strong> from the list.</li><li>The viewport of the Graph Visualizer opens for exploring the graph.</li><li>In the AQL editor, use the following query to explore communities and
entities:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-aql data-lang=aql><span class=line><span class=cl><span class=kr>FOR</span> <span class=n>c</span> <span class=kr>IN</span> <span class=n>Communities</span>
</span></span><span class=line><span class=cl>  <span class=kr>FILTER</span> <span class=n>c</span><span class=p>.</span><span class=n>_key</span> <span class=o>==</span> <span class=s2>&#34;0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>FOR</span> <span class=n>v</span><span class=p>,</span><span class=n>e</span><span class=p>,</span><span class=n>p</span> <span class=kr>IN</span> <span class=mi>1</span> <span class=kr>INBOUND</span> <span class=n>c</span> <span class=kr>GRAPH</span> <span class=s2>&#34;KnowledgeGraph&#34;</span>
</span></span><span class=line><span class=cl>  <span class=kr>RETURN</span> <span class=n>p</span></span></span></code></pre></div><p>You can also configure the display options:</p><ul><li>Set all <strong>Nodes</strong> collections (e.g., Communities, Entities) to a different color.</li><li>Set the <strong>Communities</strong> label to <code>title</code>.</li><li>Set the <strong>Entities</strong> label to <code>entity_name</code>.</li><li>For <strong>Edges</strong> (relations), set the label to <code>type</code>.</li></ul><h2 id=step-3-query-the-knowledge-graph-with-the-retriever-service>Step 3: Query the Knowledge Graph with the Retriever service <a href=/3.12/data-science/graphrag/tutorial-notebook/#step-3-query-the-knowledge-graph-with-the-retriever-service class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>To retrieve information from the Knowledge Graph, you need to deploy the
Retriever service. This service interacts with your Knowledge Graph
and uses an LLM to formulate answers to your queries.</p><h3 id=startup-parameters>Startup parameters <a href=/3.12/data-science/graphrag/tutorial-notebook/#startup-parameters class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><ul><li><code>api_provider</code>: Defines to which LLM provider you want to connect (e.g., <code>ollama</code>, <code>openai</code>).
<code>ollama</code> is intended for private LLM usage.</li><li><code>openai_api_key</code>: An API key for usage with ChatGPT. This is only required when
<code>openai</code> is selected as the provider.</li><li><code>db_name</code>: The name of the database where your Knowledge Graph was created.</li><li><code>username</code>: The ArangoDB username. This user needs to have write access to the specified database.</li></ul><h3 id=start-the-retriever-service>Start the Retriever service <a href=/3.12/data-science/graphrag/tutorial-notebook/#start-the-retriever-service class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=o>%%</span><span class=n>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Start the GraphRAG Retriever service</span>
</span></span><span class=line><span class=cl><span class=n>retriever_config</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;db_name&#34;</span><span class=p>:</span> <span class=n>DB_NAME</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;username&#34;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s2>&#34;USERNAME&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;api_provider&#34;</span><span class=p>:</span> <span class=s2>&#34;openai&#34;</span><span class=p>,</span> <span class=c1># Change this provider if needed</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;openai_api_key&#34;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s2>&#34;OPENAI_API_KEY&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>response</span> <span class=o>=</span> <span class=n>start_service</span><span class=p>(</span><span class=s2>&#34;arangodb-graphrag-retriever&#34;</span><span class=p>,</span> <span class=n>retriever_config</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pprint</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Extract the service ID for future reference</span>
</span></span><span class=line><span class=cl><span class=n>retriever_service_id</span> <span class=o>=</span> <span class=n>response</span><span class=p>[</span><span class=s2>&#34;serviceInfo&#34;</span><span class=p>][</span><span class=s2>&#34;serviceId&#34;</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;-&#34;</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Retriever Service ID: </span><span class=si>{</span><span class=n>retriever_service_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>The Retriever service is available at the following endpoint, which allows you
to send queries to the Knowledge Graph:</p><pre tabindex=0><code>/graphrag/retriever/{service_id}/v1/graphrag-query
</code></pre><h3 id=query-parameters>Query parameters <a href=/3.12/data-science/graphrag/tutorial-notebook/#query-parameters class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>The <code>POST /v1/graphrag-query</code> API expects the following parameters:</p><ul><li><code>query</code>: The question you want to ask.</li><li><code>query_type</code>: Can be <code>1</code> for a global search (information from the entire KG)
or <code>2</code> for a local search (focused on specific subgraphs).</li><li><code>level</code>: Recommended value is <code>1</code>. This parameter is relevant for global searches
and defines the hierarchy level of community grouping to start from.</li><li><code>provider</code>: Must be <code>0</code> for public LLMs like OpenAI. Use <code>1</code> for private LLMs.</li></ul><h3 id=example-global-search>Example: Global search <a href=/3.12/data-science/graphrag/tutorial-notebook/#example-global-search class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Global retrieval focuses on extracting information from the entire Knowledge Graph.
It is designed to provide a comprehensive overview and answer queries that span
across multiple entities and relationships in the graph.</p><p>For example, you can ask a broad question about the main themes of the document:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=o>%%</span><span class=n>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Example for a Global Query</span>
</span></span><span class=line><span class=cl><span class=n>global_query_body</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;query&#34;</span><span class=p>:</span> <span class=s2>&#34;What are the main themes or topics covered in the document?&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;query_type&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>  <span class=c1># 1 = Global search</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;level&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;provider&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>    <span class=c1># 0 = OPENAI (based on our setup)</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;response_type&#34;</span><span class=p>:</span> <span class=s2>&#34;use_query_decomp=True use_llm_planner=True Detailed summary&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Executing Global Query...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>retrieverResponse</span> <span class=o>=</span> <span class=n>send_request</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=sa>f</span><span class=s2>&#34;/graphrag/retriever/</span><span class=si>{</span><span class=n>retriever_service_id</span><span class=si>}</span><span class=s2>/v1/graphrag-query&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>global_query_body</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;POST&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pprint</span><span class=p>(</span><span class=n>retrieverResponse</span><span class=p>[</span><span class=s2>&#34;result&#34;</span><span class=p>])</span>
</span></span></code></pre></div><h3 id=example-local-search>Example: Local search <a href=/3.12/data-science/graphrag/tutorial-notebook/#example-local-search class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h3><p>Local retrieval is a focused approach where the query is constrained to
specific subgraphs within the Knowledge Graphs. It is designed for targeted
and precise information extraction.</p><p>For example, you can ask a detailed question about entities within the
Knowledge Graph:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=o>%%</span><span class=n>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Example for a Local Query</span>
</span></span><span class=line><span class=cl><span class=n>local_query_body</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;query&#34;</span><span class=p>:</span> <span class=s2>&#34;Who are Alice&#39;s relatives?&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;query_type&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>  <span class=c1># 2 = Local search</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;level&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;provider&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>    <span class=c1># 0 = OPENAI (based on our setup)</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;response_type&#34;</span><span class=p>:</span> <span class=s2>&#34;use_query_decomp=True use_llm_planner=True Concise list&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Executing Local Query...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>retrieverResponse</span> <span class=o>=</span> <span class=n>send_request</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=sa>f</span><span class=s2>&#34;/graphrag/retriever/</span><span class=si>{</span><span class=n>retriever_service_id</span><span class=si>}</span><span class=s2>/v1/graphrag-query&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>local_query_body</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;POST&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pprint</span><span class=p>(</span><span class=n>retrieverResponse</span><span class=p>[</span><span class=s2>&#34;result&#34;</span><span class=p>])</span>
</span></span></code></pre></div><h2 id=step-4-create-a-chat-interface-via-gradio>Step 4: Create a chat interface via Gradio <a href=/3.12/data-science/graphrag/tutorial-notebook/#step-4-create-a-chat-interface-via-gradio class=header-link onclick=copyURI(event)><span></span><i class="fa fa-link"></i></a></h2><p>To make querying your Knowledge Graph more interactive, you can use Gradio to
create a simple chat interface. This allows you to submit queries and see real-time
responses from the Retriever.</p><p>First, define the functions that handle the queries through the Gradio interface:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>global_query</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=n>messages</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>yield from</span> <span class=n>query_graph</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>local_query</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=n>messages</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>yield from</span> <span class=n>query_graph</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>query_graph</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=n>query_type</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>body</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;query&#34;</span><span class=p>:</span> <span class=n>query</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=s2>&#34;query_type&#34;</span><span class=p>:</span> <span class=n>query_type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;level&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;provider&#34;</span><span class=p>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>retrieverResponse</span> <span class=o>=</span> <span class=n>send_request</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;/graphrag/retriever/</span><span class=si>{</span><span class=n>retriever_service_id</span><span class=si>}</span><span class=s2>/v1/graphrag-query&#34;</span><span class=p>,</span> <span class=n>body</span><span class=p>,</span> <span class=s2>&#34;POST&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>retrieverResponse</span><span class=p>[</span><span class=s2>&#34;result&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>result</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>current_char</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Handle escaped characters</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>current_char</span> <span class=o>==</span> <span class=s1>&#39;</span><span class=se>\\</span><span class=s1>&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>result</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>next_char</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>next_char</span> <span class=o>==</span> <span class=s1>&#39;n&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>response</span> <span class=o>+=</span> <span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>                    <span class=n>i</span> <span class=o>+=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>                    <span class=k>continue</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>+=</span> <span class=n>current_char</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=n>response</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.005</span><span class=p>)</span>
</span></span></code></pre></div><p>Then, you can launch the global retriever and the local retriever interfaces:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>gradio</span> <span class=k>as</span> <span class=nn>gr</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>gr</span><span class=o>.</span><span class=n>ChatInterface</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>title</span><span class=o>=</span><span class=s2>&#34;ArangoDB GraphRAG Global Retriever&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>fn</span><span class=o>=</span><span class=n>global_query</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>chatbot</span><span class=o>=</span><span class=n>gr</span><span class=o>.</span><span class=n>Chatbot</span><span class=p>(</span><span class=n>height</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&#34;messages&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nb>type</span><span class=o>=</span><span class=s2>&#34;messages&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>theme</span><span class=o>=</span><span class=s1>&#39;JohnSmith9982/small_and_pretty&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span><span class=o>.</span><span class=n>launch</span><span class=p>(</span><span class=n>share</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>gradio</span> <span class=k>as</span> <span class=nn>gr</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>gr</span><span class=o>.</span><span class=n>ChatInterface</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>title</span><span class=o>=</span><span class=s2>&#34;ArangoDB GraphRAG Local Retriever&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>fn</span><span class=o>=</span><span class=n>local_query</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>chatbot</span><span class=o>=</span><span class=n>gr</span><span class=o>.</span><span class=n>Chatbot</span><span class=p>(</span><span class=n>height</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&#34;messages&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nb>type</span><span class=o>=</span><span class=s2>&#34;messages&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>theme</span><span class=o>=</span><span class=s1>&#39;JohnSmith9982/small_and_pretty&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span><span class=o>.</span><span class=n>launch</span><span class=p>(</span><span class=n>share</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></div><nav class=pagination><span class=prev><a class="nav nav-prev link" href=/3.12/data-science/graphrag/web-interface/><i class="fas fa-chevron-left fa-fw"></i><p>Web Interface</p></a></span><span class=next><a class="nav nav-next link" href=/3.12/data-science/graphrag/services/><p>Services</p><i class="fas fa-chevron-right fa-fw"></i></a></span></nav></article><div class=toc-container><a class=edit-page aria-label href=https://github.com/arangodb/docs-hugo/edit/main/site/content/3.12/data-science/graphrag/tutorial-notebook.md target=_blank><i class="fab fa-fw fa-github edit-page-icon"></i></a><div class=toc><div class=toc-content><div class=toc-header><p>On this page</p></div><nav id=TableOfContents><div class=level-2><a href=#tutorial-overview>Tutorial overview</a></div><div class=level-2><a href=#prerequisites>Prerequisites</a></div><div class=level-2><a href=#environment-setup>Environment setup</a></div><div class=level-3><a href=#install-required-libraries>Install required libraries</a></div><div class=level-3><a href=#import-required-python-libraries>Import required Python libraries</a></div><div class=level-2><a href=#step-1-prepare-your-document>Step 1: Prepare your document</a></div><div class=level-2><a href=#step-2-import-your-document-to-generate-the-knowledge-graph>Step 2: Import your document to generate the Knowledge Graph</a></div><div class=level-3><a href=#start-the-importer-service>Start the Importer service</a></div><div class=level-3><a href=#submit-your-document>Submit your document</a></div><div class=level-3><a href=#visualize-and-interact-with-the-knowledge-graph>Visualize and interact with the Knowledge Graph</a></div><div class=level-2><a href=#step-3-query-the-knowledge-graph-with-the-retriever-service>Step 3: Query the Knowledge Graph with the Retriever service</a></div><div class=level-3><a href=#startup-parameters>Startup parameters</a></div><div class=level-3><a href=#start-the-retriever-service>Start the Retriever service</a></div><div class=level-3><a href=#query-parameters>Query parameters</a></div><div class=level-3><a href=#example-global-search>Example: Global search</a></div><div class=level-3><a href=#example-local-search>Example: Local search</a></div><div class=level-2><a href=#step-4-create-a-chat-interface-via-gradio>Step 4: Create a chat interface via Gradio</a></div></nav></div></div></div></div></div></section></section></div><button class="back-to-top hidden" onclick=goToTop(event) href=#><i class="fa fa-arrow-up"></i></button><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3>
<script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script>
<script type=text/javascript>window.setupDocSearch=function(e){if(!window.docsearch)return;docsearch({appId:"OK3ZBQ5982",apiKey:"500c85ccecb335d507fe4449aed12e1d",indexName:"arangodbdocs",insights:!0,container:"#searchbox",debug:!1,maxResultsPerGroup:10,searchParameters:{facetFilters:[`version:${e}`]}})}</script></body></html>